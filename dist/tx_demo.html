<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0;"><title>jsDemo</title></head><body><article><header>ABC</header><div id="test"><img id="fuck" src="" width="300" height="300"></div><div id="card"><a href="javascript:void(0)" id="pick">本地选图</a><br><a href="javascript:void(0)" id="upload">上传本张图片</a><br><a href="javascript:void(0)" id="download">下载一张图</a><br><a href="javascript:void(0)" id="record">录音</a><br><a href="javascript:void(0)" id="playVoice">播放录音</a><br><a href="javascript:void(0)" id="stopVoice">停止播放</a><br><a href="javascript:void(0)" id="uploadVoice">上传录音</a><br><a href="javascript:void(0)" id="downloadVoice">下载录音</a><br><a href="javascript:void(0)" id="scanQrCode">扫二维码</a></div></article><script>var readyFunc = function onBridgeReady() {
    var curid;
    var curAudioId;
    var playStatus = 0;
    
    // 绑定关注事件
    document.querySelector('#pick').addEventListener('click', function(e){
    	WeixinJSBridge.invoke('pickLocalImage',{
        	"scene" : "1|2",
        },function(res){
        	var x=document.getElementById("fuck");
            x.setAttribute("src", res.localIds[0]);
            curid = res.localIds[0];
       });
    });
    
    document.querySelector('#upload').addEventListener('click', function(e){
        WeixinJSBridge.invoke('uploadLocalImage',{
        	"appId" : "wx9fce185521717341",
        	"localId" : curid,
        },function(res){
            alert(res.serverId);
            var x=document.getElementById("upload");
            x.innerHTML = "上传本张图片";
        });
    });
    
    document.querySelector('#download').addEventListener('click', function(e){
        WeixinJSBridge.invoke('downloadImage',{
        	"appId" : "wx9fce185521717341",
        	"serverId" : "9i07M_GDlDfWA8-xpDpIUJEtgTe5iNwHdweromUrfRXvtW-aXULgh_9t-5FxIgbp",
        },function(res){
        	var x=document.getElementById("fuck");
            x.setAttribute("src", res.localId);
            
            var y=document.getElementById("download");
    		y.innerHTML = "下载一张图";
        });
    });
    
    document.querySelector('#record').addEventListener('click', function(e){
    WeixinJSBridge.invoke('startRecord',{
            "appId" : "wx9fce185521717341"
        },function(res){
            curAudioId = res.localId;mmb
       });
    });
    
    document.querySelector('#playVoice').addEventListener('click', function(e){
    	//0:idle 1:playing 2:pause
    	if(playStatus == 0 || playStatus == 2){
    		WeixinJSBridge.invoke('playVoice',{
            "appId" : "wx9fce185521717341",
            "localId" : curAudioId
        	},function(res){
  			});
  			
  			if(playStatus == 2){
  				var x=document.getElementById("playVoice");
    			x.innerHTML = '播放中';
  			}
  			
  			playStatus = 1;
    	}else if(playStatus == 1){
    		WeixinJSBridge.invoke('pauseVoice',{
            "appId" : "wx9fce185521717341",
            "localId" : curAudioId
        	},function(res){
  			});
  			
  			var x=document.getElementById("playVoice");
    		x.innerHTML = '暂停中';
  			playStatus = 2;
    	}
    });
    
    document.querySelector('#stopVoice').addEventListener('click', function(e){
    	WeixinJSBridge.invoke('stopVoice',{
        	"appId" : "wx9fce185521717341",
        	"localId" : curAudioId,
        },function(res){
            var y=document.getElementById("playVoice");
    		y.innerHTML = "播放录音";
        });
    });
    
    document.querySelector('#uploadVoice').addEventListener('click', function(e){
        WeixinJSBridge.invoke('uploadVoice',{
        	"appId" : "wx9fce185521717341",
        	"localId" : curAudioId,
        },function(res){
            alert(res.serverId);
            
            var y=document.getElementById("uploadVoice");
    		y.innerHTML = "上传录音";
        });
    });
    
    document.querySelector('#downloadVoice').addEventListener('click', function(e){
        WeixinJSBridge.invoke('downloadVoice',{
        	"appId" : "wx9fce185521717341",
        	"serverId" : "B4mSUv8qciaghQO_q1VYRFIuaIY00YAHo_03aWtFp9vvUJUwFQJrZDlHZXFh3sdR",
        },function(res){
        	curAudioId = res.localId;
        	alert(res.localId);
        	var y=document.getElementById("downloadVoice");
    		y.innerHTML = "下载录音";
        });
    });
    
    document.querySelector('#scanQrCode').addEventListener('click', function(e){
        WeixinJSBridge.invoke('scanQRCode',{
        	"desc" : "这是描述",
        	"needResult" : 1,  //1，直接返回扫描结果 0，微信处理结果
        },function(res){
        	alert(res.resultStr);
        });
    });
    
    WeixinJSBridge.on('onVoicePlayBegin', function(argv) {
    	var x=document.getElementById("playVoice");
    	x.innerHTML = '播放中';
    });
    
    WeixinJSBridge.on('onVoicePlayEnd', function(argv) {
    	playStatus = 0;
    	var x=document.getElementById("playVoice");
    	x.innerHTML = '播放语音';
    });
    
    WeixinJSBridge.on('onLocalImageUploadProgress', function(argv) {
    	var x=document.getElementById("upload");
    	x.innerHTML = argv.localId + ":" + argv.percent + "%";
    });
    
    WeixinJSBridge.on('onImageDownloadProgress', function(argv) {
    	var x=document.getElementById("download");
    	x.innerHTML = argv.serverId + ":" + argv.percent + "%";
    });
    
    WeixinJSBridge.on('onVoiceUploadProgress', function(argv) {
    	var x=document.getElementById("uploadVoice");
    	x.innerHTML = argv.localId + ":" + argv.percent + "%";
    });
    
    WeixinJSBridge.on('onVoiceDownloadProgress', function(argv) {
    	var x=document.getElementById("downloadVoice");
    	x.innerHTML = argv.serverId + ":" + argv.percent + "%";
    });
}


if (typeof WeixinJSBridge === "undefined") {
  document.addEventListener('WeixinJSBridgeReady', readyFunc, false);
} else {
  readyFunc();
}</script></body></html>